library(pdftools)
?download.file
download.file("https://www.census.gov/2010census/partners/pdf/FIPS_StateCounty_Code.pdf", "countynames.pdf", mode = "wb")
stateCntyCodes  <- pdf_text("countynames.pdf")
stateCntyCodes
stateCntyCodes[1]
stateCntyCodes[1] %>% strsplit("\r\n")
stateCntyCodes[2] %>% strsplit("\r\n")
stateCntyCodes[10] %>% strsplit("\r\n")
stateCntyCodes[10] %>% strsplit("\r\n") %>% strsplit('IN')
stateCntyCodes[10] %>% strsplit("\r\n") %>% strsplit("IN")
stateCntyCodes[10] %>% strsplit("\r\n") %>% unlist()
stateCntyCodes[10] %>% strsplit("\r\n") %>% unlist() %>% strsplit("IN")
stateCntyCodes[10] %>% strsplit("\r\n") %>% unlist() %>% strsplit(c("IN", "IL"))
stateCntyCodes[10] %>% strsplit("\r\n") %>% unlist() %>% strsplit("IN", "IL")
?strsplit
stateCntyCodes[10] %>% strsplit("\r\n") %>% unlist() %>% strsplit("I.")
stateCntyCodes[10] %>% strsplit("\r\n") %>% unlist() %>% strsplit("I.") %>% lapply("[[", c(1,2))
stateCntyCodes[10] %>% strsplit("\r\n") %>% unlist() %>% strsplit("I.") %>% lapply("[[", 1)
stateCntyCodes[11] %>% strsplit("\r\n") %>% unlist() %>% strsplit("I.")
stateCntyCodes[11][-c(1,40)] %>% strsplit("\r\n") %>% unlist() %>% strsplit("I.")
stateCntyCodes[11][-c(1,40)]
stateCntyCodes[11] %>% strsplit("\r\n") %>% unlist() %>% strsplit("I.")
stateCntyCodes[11]
stateCntyCodes[11] %>% strsplit("\r\n")
stateCntyCodes[11] %>% strsplit("\r\n") %>% unlist()
stateCntyCodes[11] %>% strsplit("\r\n") %>% unlist()[-1] %>% strsplit("I.")
stateCntyCodes[11] %>% strsplit("\r\n") %>% unlist()[-1]
stateCntyCodes[11] %>% strsplit("\r\n") %>% unlist() %>% strsplit("I.")
stateCntyCodes[10] %>% strsplit("\r\n") %>% unlist() %>% strsplit("I.")
stateCntyCodes[10] %>% strsplit("\r\n")
stateCntyCodes[10] %>% strsplit("\r\n") %>% unlist()
a <- stateCntyCodes[10] %>% strsplit("\r\n") %>% unlist()
a[1]
a[1,40]
a[c(1,40)]
temp[c(1,40)] %>% strsplit("I.")
temp <- stateCntyCodes[10] %>% strsplit("\r\n") %>% unlist()
temp[c(1,40)] %>% strsplit("I.")
temp[-c(1,40)] %>% strsplit("I.")
temp[-c(1,40)] %>% strsplit("I.") %>% unlist()
temp[-c(1,40)] %>% strsplit("I.") %>% unlist() %>% strsplit("  ")
temp[-c(1,40)] %>% strsplit("I.") %>% unlist() %>% strsplit("  .")
temp[-c(1,40)] %>% strsplit("I.") %>% unlist() %>% strsplit("  ")
temp[-c(1,40)] %>% strsplit("I.") %>% unlist() %>% strsplit("   ")
temp[-c(1,40)] %>% strsplit("I.") %>% unlist() %>% strsplit("   ") %>% unlist() %>% strsplit(" ")
temp[-c(1,40)] %>% strsplit("I.") %>% unlist() %>% strsplit("   ") %>% unlist() %>% strsplit(" ") %>% unlist()
temp[-c(1,40)] %>% strsplit("I.") %>% unlist() %>% strsplit("   ") %>% unlist() %>% strsplit("  ") %>% unlist()
temp[-c(1,40)] %>% strsplit("I.") %>% unlist() %>% strsplit("   ") %>% unlist() %>%
strsplit("  ") %>% unlist() %>% length()
temp[-c(1,40)] %>% strsplit("I.") %>% unlist() %>% strsplit("   ") %>% unlist() %>%
strsplit("  ") %>% unlist() %>% apply(length
stateCntyCodes[11] %>% strsplit("\r\n") %>% unlist() %>% strsplit("I.")
zipCnty = read.table("zcta_county_rel_10.txt", sep = ",", colClasses = c("character"),
header = TRUE)
data(zipcode)
zipMap = merge(zipCnty[, c("ZCTA5", "STATE", "COUNTY")],
zipcode[, c("zip","city")], by.x = "ZCTA5", by.y = "zip")
zipMap = merge(zipMap, stateCntyCodes, by.x = c("STATE", "COUNTY"), by.y = c("fipstate",
"fipscty"))
zipMap$stname = sapply(zipMap2$ctyname, function(x) str_split(x, ",")[[1]][2])
save(zipMap, file = "zipCityCountyStateMap.Rda")
temp[-c(1,40)] %>% strsplit("I.") %>% unlist() %>% strsplit("   ") %>% unlist() %>%
strsplit("  ") %>% unlist() %>% apply(length)
temp[-c(1,40)] %>% strsplit("I.") %>% unlist() %>% strsplit("   ") %>% unlist() %>%
strsplit("  ") %>% unlist() %>% sapply(length)
temp[-c(1,40)] %>% strsplit("I.") %>% unlist() %>% strsplit("   ") %>% unlist() %>%
strsplit("  ") %>% unlist()
temp[-c(1,40)] %>% strsplit("I.") %>% unlist() %>% strsplit("   ") %>% unlist() %>%
strsplit("  ") %>% unlist() %>% nchar()
temp <- stateCntyCodes[10] %>% strsplit("\r\n") %>% unlist()
temp <- temp[-c(1,40)] %>% strsplit("I.") %>% unlist() %>% strsplit("   ") %>% unlist() %>%
strsplit("  ") %>% unlist()
tem;
temp
temp %<>% subset(nchar(temp) > 1)
temp <- subset(temp, nchar(temp) > 1)
temp
temp <- subset(temp, nchar(temp) > 1) %>% strsplit(" ") %>% unlist()
temp
temp <- stateCntyCodes[10] %>% strsplit("\r\n") %>% unlist()
temp <- temp[-c(1,40)] %>% strsplit("I.") %>% unlist() %>% strsplit("   ") %>% unlist() %>%
strsplit("  ") %>% unlist()
subset(temp, nchar(temp) > 1) %>% strsplit(" ") %>% unlist() %>% paste(sep=" ")
?paste
subset(temp, nchar(temp) > 1) %>% strsplit(" ") %>% unlist() %>% paste(sep=" ", collapse=TRUE)
subset(temp, nchar(temp) > 1) %>% strsplit(" ") %>% unlist() %>% paste(collapse=" ")
subset(temp, nchar(temp) > 1) %>% strsplit(" ") %>% unlist() %>% paste(collapse=" ") %>% strsplit(".. ... ")
subset(temp, nchar(temp) > 1) %>% strsplit(" ") %>% unlist() %>% paste(collapse=" ") %>% strsplit(" .. ... ")
subset(temp, nchar(temp) > 1) %>% strsplit(" ") %>% unlist() %>% paste(collapse=" ") %>% strsplit(" .. ... ")
subset(temp, nchar(temp) > 1) %>% strsplit(" ") %>% unlist() %>% paste(collapse=" ") %>%
strsplit(" .. ... ") %>% unlist()
temp <- subset(temp, nchar(temp) > 1) %>% strsplit(" ") %>% unlist() %>% paste(collapse=" ")
temp
counties <- temp %>% strsplit(" .. ... ") %>% unlist()
counties
library(magrittr)
counties[1] %<>% strsplit(" ") %>% lapply("[[",3)
counties
temp <- stateCntyCodes[10] %>% strsplit("\r\n") %>% unlist()
temp <- temp[-c(1,40)] %>% strsplit("I.") %>% unlist() %>% strsplit("   ") %>% unlist() %>%
strsplit("  ") %>% unlist()
temp %<>% subset(nchar(temp) > 1) %>% strsplit(" ") %>% unlist() %>% paste(collapse=" ")
counties <- temp %>% strsplit(" .. ... ") %>% unlist()
counties[1] %<>% strsplit(" ") %>% lapply("[[",3) %>% unlist()
statecode <- temp %>% strsplit(" ") %>% lapply("[[",1) %>% unlist()
statecodes <- temp %>% strsplit(" ... ") %>% lapply("[[",1) %>% unlist()
temp %>% strsplit(" ... ")
temp %>% strsplit(" .. ... ")
temp
temp %>% strsplit(" ... ")
temp %>% strsplit(".. ")
countycodes <- temp %>% strsplit("18 ")
temp %>% strsplit("18 ")
rm(statecode)
rm(statecodes)
rm(countycodes)
temp <- stateCntyCodes[10] %>% strsplit("\r\n") %>% unlist()
temp <- temp[-c(1,40)] %>% strsplit("I.") %>% unlist() %>% strsplit("   ") %>% unlist() %>%
strsplit("  ") %>% unlist()
temp %<>% subset(nchar(temp) > 1) %>% strsplit(" ") %>% unlist() %>% paste(collapse=" ")
counties <- temp %>% strsplit(" .. ... ") %>% unlist()
counties[1] %<>% strsplit(" ") %>% lapply("[[",3) %>% unlist()
temp
temp %>% strsplit(" ")
temp %>% strsplit(" ") %>% unlist()
allsplit <- temp %>% strsplit(" ") %>% unlist()
allsplit %<>% subset(nchar(allsplit) == 2)
allsplit
allsplit <- temp %>% strsplit(" ") %>% unlist()
allsplit %<>% subset(allsplit %in% c("17","18","19"))
allsplit
statecodes <- subset(allsplit, allsplit %in% c("17","18","19"))
subset(allaplit, nchar(allsplit) == 3)
subset(allsplit, nchar(allsplit) == 3)
allsplit
allsplit <- temp %>% strsplit(" ") %>% unlist()
subset(allsplit, nchar(allsplit) == 3)
temp <- stateCntyCodes[10] %>% strsplit("\r\n") %>% unlist()
temp <- temp[-c(1,40)] %>% strsplit("I.") %>% unlist() %>% strsplit("   ") %>% unlist() %>%
strsplit("  ") %>% unlist()
temp %<>% subset(nchar(temp) > 1) %>% strsplit(" ") %>% unlist() %>% paste(collapse=" ")
allsplit <- temp %>% strsplit(" ") %>% unlist()
statecodes <- subset(allsplit, allsplit %in% c("17","18","19"))
countycodes <- subset(allsplit, nchar(allsplit) == 3)
counties <- temp %>% strsplit(" .. ... ") %>% unlist()
counties[1] %<>% strsplit(" ") %>% lapply("[[",3) %>% unlist()
cbind(statecodes, countycodes, counties)
countycodes <- subset(allsplit, nchar(allsplit) == 3 & allsplit != "Jay")
cbind(statecodes, countycodes, counties)
as.data.frame(statecodes, countycodes, counties)
as.data.frame(c(statecodes, countycodes, counties))
cbind(statecodes, countycodes, counties) %>% as.data.frame
temp <- stateCntyCodes[11] %>% strsplit("\r\n") %>% unlist()
temp <- temp[-c(1,40)] %>% strsplit("I.") %>% unlist() %>% strsplit("   ") %>% unlist() %>%
strsplit("  ") %>% unlist()
temp %<>% subset(nchar(temp) > 1) %>% strsplit(" ") %>% unlist() %>% paste(collapse=" ")
allsplit <- temp %>% strsplit(" ") %>% unlist()
statecodes <- subset(allsplit, allsplit %in% c("17","18","19"))
countycodes <- subset(allsplit, nchar(allsplit) == 3 & allsplit != "Jay")
counties <- temp %>% strsplit(" .. ... ") %>% unlist()
counties[1] %<>% strsplit(" ") %>% lapply("[[",3) %>% unlist()
tabl <- cbind(statecodes, countycodes, counties) %>% as.data.frame
temp <- stateCntyCodes[11] %>% strsplit("\r\n") %>% unlist()
temp <- temp[-c(1,40)] %>% strsplit("I.") %>% unlist() %>% strsplit("   ") %>% unlist() %>%
strsplit("  ") %>% unlist()
temp %<>% subset(nchar(temp) > 1) %>% strsplit(" ") %>% unlist() %>% paste(collapse=" ")
allsplit <- temp %>% strsplit(" ") %>% unlist()
statecodes <- subset(allsplit, allsplit %in% c("17","18","19"))
countycodes <- subset(allsplit, nchar(allsplit) == 3 & allsplit != "Jay")
counties <- temp %>% strsplit(" .. ... ") %>% unlist()
counties[1] %<>% strsplit(" ") %>% lapply("[[",3) %>% unlist()
tabl <- cbind(statecodes, countycodes, counties) %>% as.data.frame
statecodes
countycodes
countycodes <- subset(allsplit, nchar(allsplit) == 3 & allsplit != "Jay"& allsplit != "St."& allsplit != "Des")
tabl <- cbind(statecodes, countycodes, counties) %>% as.data.frame
stateCntyCodes <- do.call("rbind", tabl)
tabl <- list()
for (i in 10:11){
temp <- stateCntyCodes[11] %>% strsplit("\r\n") %>% unlist()
temp <- temp[-c(1,40)] %>% strsplit("I.") %>% unlist() %>% strsplit("   ") %>% unlist() %>%
strsplit("  ") %>% unlist()
temp %<>% subset(nchar(temp) > 1) %>% strsplit(" ") %>% unlist() %>% paste(collapse=" ")
allsplit <- temp %>% strsplit(" ") %>% unlist()
statecodes <- subset(allsplit, allsplit %in% c("17","18","19"))
countycodes <- subset(allsplit, nchar(allsplit) == 3 & allsplit != "Jay"& allsplit != "St."& allsplit != "Des")
counties <- temp %>% strsplit(" .. ... ") %>% unlist()
counties[1] %<>% strsplit(" ") %>% lapply("[[",3) %>% unlist()
tabl[[i]] <- cbind(statecodes, countycodes, counties) %>% as.data.frame
}
stateCntyCodes <- do.call("rbind", tabl)
tabl <- list()
for (i in 10:11){
temp <- stateCntyCodes[i] %>% strsplit("\r\n") %>% unlist()
temp <- temp[-c(1,40)] %>% strsplit("I.") %>% unlist() %>% strsplit("   ") %>% unlist() %>%
strsplit("  ") %>% unlist()
temp %<>% subset(nchar(temp) > 1) %>% strsplit(" ") %>% unlist() %>% paste(collapse=" ")
allsplit <- temp %>% strsplit(" ") %>% unlist()
statecodes <- subset(allsplit, allsplit %in% c("17","18","19"))
countycodes <- subset(allsplit, nchar(allsplit) == 3 & allsplit != "Jay"& allsplit != "St."& allsplit != "Des")
counties <- temp %>% strsplit(" .. ... ") %>% unlist()
counties[1] %<>% strsplit(" ") %>% lapply("[[",3) %>% unlist()
tabl[[i]] <- cbind(statecodes, countycodes, counties) %>% as.data.frame
}
i
stateCntyCodes[i] %>% strsplit("\r\n")
stateCntyCodes[10] %>% strsplit("\r\n")
stateCntyCodes  <- pdf_text("countynames.pdf")
tabl <- list()
for (i in 10:11){
temp <- stateCntyCodes[i] %>% strsplit("\r\n") %>% unlist()
temp <- temp[-c(1,40)] %>% strsplit("I.") %>% unlist() %>% strsplit("   ") %>% unlist() %>%
strsplit("  ") %>% unlist()
temp %<>% subset(nchar(temp) > 1) %>% strsplit(" ") %>% unlist() %>% paste(collapse=" ")
allsplit <- temp %>% strsplit(" ") %>% unlist()
statecodes <- subset(allsplit, allsplit %in% c("17","18","19"))
countycodes <- subset(allsplit, nchar(allsplit) == 3 & allsplit != "Jay"& allsplit != "St."& allsplit != "Des")
counties <- temp %>% strsplit(" .. ... ") %>% unlist()
counties[1] %<>% strsplit(" ") %>% lapply("[[",3) %>% unlist()
tabl[[i]] <- cbind(statecodes, countycodes, counties) %>% as.data.frame
}
stateCntyCodes <- do.call("rbind", tabl)
stateCntyCodes <- do.call("rbind", tabl) %>% subset(statecodes == "18")
zipCnty = read.table("zcta_county_rel_10.txt", sep = ",", colClasses = c("character"),
header = TRUE)
data(zipcode)
zipMap = merge(zipCnty[, c("ZCTA5", "STATE", "COUNTY")],
zipcode[, c("zip","city")], by.x = "ZCTA5", by.y = "zip")
zipMap = merge(zipMap, stateCntyCodes, by.x = c("STATE", "COUNTY"), by.y = c("fipstate",
"fipscty"))
colnames(stateCntyCodes) <- c("fipstate","fipscty","ctyname")
zipMap = merge(zipMap, stateCntyCodes, by.x = c("STATE", "COUNTY"), by.y = c("fipstate",
"fipscty"))
zipMap$stname = sapply(zipMap2$ctyname, function(x) str_split(x, ",")[[1]][2])
zipMap$stname = sapply(zipMap$ctyname, function(x) str_split(x, ",")[[1]][2])
save(zipMap, file = "zipCityCountyStateMap.Rda")
cntyList=c("Marion County, IN",
"Hamilton County, IN",
"Boone County, IN",
"Hendricks County, IN",
"Johnson County, IN",
"Shelby County, IN",
"Hancock County, IN")
zipIndy=zipMap[zipMap$ctyname %in% cntyList,]
zipIndy2=zipIndy[!duplicated(zipIndy$ZCTA5),]
head(zipIndy2)
zipIndy
cntyList=c("Marion County",
"Hamilton County",
"Boone County",
"Hendricks County",
"Johnson County",
"Shelby County",
"Hancock County")
zipIndy=zipMap[zipMap$ctyname %in% cntyList,]
zipIndy2=zipIndy[!duplicated(zipIndy$ZCTA5),]
head(zipIndy2)
zipIndy
cntyList=c("Marion",
"Hamilton",
"Boone",
"Hendricks",
"Johnson",
"Shelby",
"Hancock")
zipIndy=zipMap[zipMap$ctyname %in% cntyList,]
zipIndy2=zipIndy[!duplicated(zipIndy$ZCTA5),]
head(zipIndy2)
cntyList=c("St. Joseph")
zipIndy=zipMap[zipMap$ctyname %in% cntyList,]
zipIndy2=zipIndy[!duplicated(zipIndy$ZCTA5),]
head(zipIndy2)
cntyList=c("St. Joseph")
# get list of zips in the greater Indianapolis area
zips=zipMap[zipMap$ctyname %in% cntyList,]
# remove duplicates (due to a zip in multiple counties)
zips2=zips[!duplicated(zips$ZCTA5),]
head(zips2)
zips2
zips
stateCntyCodes
stateCntyCodes <- rbind(stateCntyCodes, c("26","027","Cass"))
stateCntyCodes <- sapply(stateCntyCodes, as.characer)
stateCntyCodes <- sapply(stateCntyCodes, as.characer())
stateCntyCodes <- sapply(stateCntyCodes, as.character)
stateCntyCodes <- rbind(stateCntyCodes, c("26","027","Cass"))
stateCntyCodes
stateCntyCodes <- do.call("rbind", tabl) %>% subset(statecodes == "18")
colnames(stateCntyCodes) <- c("fipstate","fipscty","ctyname")
stateCntyCodes <- sapply(stateCntyCodes, as.character)
stateCntyCodes <- rbind(stateCntyCodes, c("26","027","Cass"))
stateCntyCodes
stateCntyCodes <- rbind(stateCntyCodes, c("26","027","Cass")) %>% sapply(stateCntyCodes, as.factor)
stateCntyCodes <- sapply(stateCntyCodes, as.factor)
stateCntyCodes <- do.call("rbind", tabl) %>% subset(statecodes == "18")
colnames(stateCntyCodes) <- c("fipstate","fipscty","ctyname")
stateCntyCodes <- sapply(stateCntyCodes, as.character)
stateCntyCodes <- rbind(stateCntyCodes, c("26","027","Cass"))
stateCntyCodes <- sapply(stateCntyCodes, as.factor)
stateCntyCodes <- do.call("rbind", tabl) %>% subset(statecodes == "18")
colnames(stateCntyCodes) <- c("fipstate","fipscty","ctyname")
stateCntyCodes <- sapply(stateCntyCodes, as.character)
stateCntyCodes <- rbind(stateCntyCodes, c("26","027","Cass"))
stateCntyCodes <- rbind(stateCntyCodes, c("26","027","Cass")) %>% as.data.frame()
stateCntyCodes <- sapply(stateCntyCodes, as.factor)
stateCntyCodes <- do.call("rbind", tabl) %>% subset(statecodes == "18")
colnames(stateCntyCodes) <- c("fipstate","fipscty","ctyname")
stateCntyCodes <- sapply(stateCntyCodes, as.character)
stateCntyCodes <- rbind(stateCntyCodes, c("26","027","Cass")) %>% as.data.frame()
stateCntyCodes <- sapply(stateCntyCodes, as.factor)
stateCntyCodes <- sapply(stateCntyCodes, as.factor) %>% as,data.frame()
stateCntyCodes <- do.call("rbind", tabl) %>% subset(statecodes == "18")
colnames(stateCntyCodes) <- c("fipstate","fipscty","ctyname")
stateCntyCodes <- sapply(stateCntyCodes, as.character)
stateCntyCodes <- rbind(stateCntyCodes, c("26","027","Cass")) %>% as.data.frame()
stateCntyCodes <- sapply(stateCntyCodes, as.factor) %>% as,data.frame()
stateCntyCodes <- do.call("rbind", tabl) %>% subset(statecodes == "18")
colnames(stateCntyCodes) <- c("fipstate","fipscty","ctyname")
stateCntyCodes <- sapply(stateCntyCodes, as.character)
stateCntyCodes <- rbind(stateCntyCodes, c("26","027","Cass")) %>% as.data.frame()
stateCntyCodes <- sapply(stateCntyCodes, as.factor) %>% as.data.frame()
cntyList=c("St. Joseph","Cass")
zips=zipMap[zipMap$ctyname %in% cntyList,]
zips2=zips[!duplicated(zips$ZCTA5),]
head(zips2)
stateCntyCodes <- do.call("rbind", tabl) %>% subset(statecodes == "18")
colnames(stateCntyCodes) <- c("fipstate","fipscty","ctyname")
stateCntyCodes$stname <- rep("IN", dim(stateCntyCodes)[1])
stateCntyCodes <- sapply(stateCntyCodes, as.character)
stateCntyCodes <- rbind(stateCntyCodes, c("26","027","Cass","MI")) %>% as.data.frame()
stateCntyCodes <- sapply(stateCntyCodes, as.factor) %>% as.data.frame()
zipCnty = read.table("zcta_county_rel_10.txt", sep = ",", colClasses = c("character"),
header = TRUE)
data(zipcode)
zipMap = merge(zipCnty[, c("ZCTA5", "STATE", "COUNTY")],
zipcode[, c("zip","city")], by.x = "ZCTA5", by.y = "zip")
zipMap = merge(zipMap, stateCntyCodes, by.x = c("STATE", "COUNTY"), by.y = c("fipstate",
"fipscty"))
zipMap$stname = sapply(zipMap$ctyname, function(x) str_split(x, ",")[[1]][2])
save(zipMap, file = "zipCityCountyStateMap.Rda")
cntyList=c("St. Joseph","Cass")
# get list of zips in the South Bend area
zips=zipMap[zipMap$ctyname %in% cntyList,]
# remove duplicates (due to a zip in multiple counties)
zips2=zips[!duplicated(zips$ZCTA5),]
head(zips2)
stateCntyCodes <- do.call("rbind", tabl) %>% subset(statecodes == "18")
colnames(stateCntyCodes) <- c("fipstate","fipscty","ctyname")
stateCntyCodes$stname <- rep("IN", dim(stateCntyCodes)[1])
stateCntyCodes <- sapply(stateCntyCodes, as.character)
stateCntyCodes <- rbind(stateCntyCodes, c("26","027","Cass","MI")) %>% as.data.frame()
stateCntyCodes <- sapply(stateCntyCodes, as.factor) %>% as.data.frame()
zipCnty = read.table("zcta_county_rel_10.txt", sep = ",", colClasses = c("character"),
header = TRUE)
data(zipcode)
zipMap = merge(zipCnty[, c("ZCTA5", "STATE", "COUNTY")],
zipcode[, c("zip","city")], by.x = "ZCTA5", by.y = "zip")
zipMap = merge(zipMap, stateCntyCodes, by.x = c("STATE", "COUNTY"), by.y = c("fipstate",
"fipscty"))
save(zipMap, file = "zipCityCountyStateMap.Rda")
cntyList=c("St. Joseph","Cass")
# get list of zips in the South Bend area
zips=zipMap[zipMap$ctyname %in% cntyList,]
# remove duplicates (due to a zip in multiple counties)
zips2=zips[!duplicated(zips$ZCTA5),]
head(zips2)
stateCntyCodes <- do.call("rbind", tabl) %>% subset(statecodes == "18")
colnames(stateCntyCodes) <- c("fipstate","fipscty","ctyname")
stateCntyCodes <- sapply(stateCntyCodes, as.character)
stateCntyCodes <- rbind(stateCntyCodes, c("26","027","Cass")) %>% as.data.frame()
stateCntyCodes <- sapply(stateCntyCodes, as.factor) %>% as.data.frame()
zipCnty = read.table("zcta_county_rel_10.txt", sep = ",", colClasses = c("character"),
header = TRUE)
data(zipcode)
zipMap = merge(zipCnty[, c("ZCTA5", "STATE", "COUNTY")],
zipcode[, c("zip","city")], by.x = "ZCTA5", by.y = "zip")
zipMap = merge(zipMap, stateCntyCodes, by.x = c("STATE", "COUNTY"), by.y = c("fipstate",
"fipscty"))
save(zipMap, file = "zipCityCountyStateMap.Rda")
cntyList=c("St. Joseph","Cass")
# get list of zips in the South Bend area
zips=zipMap[zipMap$ctyname %in% cntyList,]
# remove duplicates (due to a zip in multiple counties)
zips2=zips[!duplicated(zips$ZCTA5),]
head(zips2)
cntyList=c("St. Joseph") #,"Cass")
zips=zipMap[zipMap$ctyname %in% cntyList,]
zips2=zips[!duplicated(zips$ZCTA5),]
head(zips2)
?readShapePoly
install.packages(sf)
install.packages("sf")
head(zips2)
library(acs)
install.packages("acs")
library(sf)
?st_read
sipShp <- st_read("cb_2015_us_zcta510_500k//cb_2015_us_zcta510_500k.shp")
zipShp2=zipShp[zipShp$id %in% zips2$ZCTA5,]
zipShp <- st_read("cb_2015_us_zcta510_500k//cb_2015_us_zcta510_500k.shp")
zipShp2=zipShp[zipShp$id %in% zips2$ZCTA5,]
zipShp$id
zipShp2=zipShp[zipShp$ZCTA5CE10 %in% zips2$ZCTA5,]
x=get_googlemap(center="south bend",maptype=c("roadmap"))
ggmap(x)
map + geom_polygon(sipShp2, aes(x=long, y=lat, group=id), fill = "blue", color = "black", alpha = .2)
map <- ggmap(x)
map + geom_polygon(sipShp2, aes(x=long, y=lat, group=id), fill = "blue", color = "black", alpha = .2)
map + geom_polygon(zipShp2, aes(x=long, y=lat, group=id), fill = "blue", color = "black", alpha = .2)
class(zipShp)
?fortify
zipShp <- fortify(zipShp,region="ZCTA5CE10")
zipShp2=zipShp[zipShp$ZCTA5CE10 %in% zips2$ZCTA5,]
x=get_googlemap(center="south bend",maptype=c("roadmap"))
map <- ggmap(x)
map + geom_polygon(zipShp2, aes(x=long, y=lat, group=id), fill = "blue", color = "black", alpha = .2)
View(zipShp2)
?st_read
zipShp <- readShapePoly("cb_2015_us_zcta510_500k//cb_2015_us_zcta510_500k.shp")
install.packages("rgdal")
zipShp <- rgdal::readOGR("cb_2015_us_zcta510_500k//cb_2015_us_zcta510_500k.shp")
zipShp <- fortify(zipShp,region="ZCTA5CE10")
zipShp2 <- zipShp[zipShp$ZCTA5CE10 %in% zips2$ZCTA5,]
zipShp2 <- fortify(zipShp2,region="ZCTA5CE10")
map <- ggmap(x)
map + geom_polygon(zipShp2, aes(x=long, y=lat, group=id), fill = "blue", color = "black", alpha = .2)
class(zipShp2)
map + geom_polygon(data=zipShp2, aes(x=long, y=lat, group=id), fill = "blue", color = "black", alpha = .2)
cntyList=c("St. Joseph","Cass")
zips=zipMap[zipMap$ctyname %in% cntyList,]
zips2=zips[!duplicated(zips$ZCTA5),]
head(zips2)
zipShp <- rgdal::readOGR("cb_2015_us_zcta510_500k//cb_2015_us_zcta510_500k.shp")
zipShp2 <- zipShp[zipShp$ZCTA5CE10 %in% zips2$ZCTA5,]
zipShp2 <- fortify(zipShp2,region="ZCTA5CE10")
x <- get_googlemap(center="south bend",maptype=c("roadmap"))
map <- ggmap(x)
map + geom_polygon(data=zipShp2, aes(x=long, y=lat, group=id), fill = "blue", color = "black", alpha = .2)
?api.key.install
library(acs)
?api.key.install
api.key.install(4f56e4ff2ade70c0c3cc47779dd337334e6703d6)
api.key.install("4f56e4ff2ade70c0c3cc47779dd337334e6703d6")
?acs.fetch
?geo.make
zips2$ZCTA5
geo.make(zip.code = zips2$ZCTA5)
acs.fetch(2011, geography = geo.make(zip.code = zips2$ZCTA5))
?acs.lookup
acs.lookup(endyear=2000, dataset="sf3", table.number="P56")
acs.lookup(endyear=2014, span=5, table.name="Income")
acs.lookup(endyear=2012, span=5,dataset="acs", keyword= c("owner", "occupied", "median"), case.sensitive=F)
acs.lookup(endyear=2015, span=5,dataset="acs", keyword= c("owner", "occupied", "median"), case.sensitive=F)
acs.lookup(endyear=2010, span=5,dataset="acs", keyword= c("owner", "occupied", "median"), case.sensitive=F)
property_info <- acs.fetch(2011, geography = geo.make(zip.code = zips2$ZCTA5), table.number = c("B25021","B25037","B25039","B25119","B25077"))
household_income <- acs.fetch(2011, geography = geo.make(zip.code = zips2$ZCTA5), table.number = "B25119")
household_income <- acs.fetch(2015, geography = geo.make(zip.code = zips2$ZCTA5), table.number = "B25119")
household_income
household_income@estimate
household_income@acs.units
library(stringr)
library(zipcode)
library(pdftools)
download.file("https://www.census.gov/2010census/partners/pdf/FIPS_StateCounty_Code.pdf", "countynames.pdf", mode = "wb")
stateCntyCodes  <- pdf_text("countynames.pdf")
#parse PDF file to get IN data
tabl <- list()
for (i in 10:11){
temp <- stateCntyCodes[i] %>% strsplit("\r\n") %>% unlist()
temp <- temp[-c(1,40)] %>% strsplit("I.") %>% unlist() %>% strsplit("   ") %>% unlist() %>%
strsplit("  ") %>% unlist()
temp %<>% subset(nchar(temp) > 1) %>% strsplit(" ") %>% unlist() %>% paste(collapse=" ")
allsplit <- temp %>% strsplit(" ") %>% unlist()
statecodes <- subset(allsplit, allsplit %in% c("17","18","19"))
countycodes <- subset(allsplit, nchar(allsplit) == 3 & allsplit != "Jay"& allsplit != "St."& allsplit != "Des")
counties <- temp %>% strsplit(" .. ... ") %>% unlist()
counties[1] %<>% strsplit(" ") %>% lapply("[[",3) %>% unlist()
tabl[[i]] <- cbind(statecodes, countycodes, counties) %>% as.data.frame
}
stateCntyCodes <- do.call("rbind", tabl) %>% subset(statecodes == "18")
colnames(stateCntyCodes) <- c("fipstate","fipscty","ctyname")
stateCntyCodes <- sapply(stateCntyCodes, as.character)
stateCntyCodes <- rbind(stateCntyCodes, c("26","027","Cass")) %>% as.data.frame()
stateCntyCodes <- sapply(stateCntyCodes, as.factor) %>% as.data.frame()
zipCnty = read.table("zcta_county_rel_10.txt", sep = ",", colClasses = c("character"),
header = TRUE)
data(zipcode)
zipMap = merge(zipCnty[, c("ZCTA5", "STATE", "COUNTY")],
zipcode[, c("zip","city")], by.x = "ZCTA5", by.y = "zip")
zipMap = merge(zipMap, stateCntyCodes, by.x = c("STATE", "COUNTY"), by.y = c("fipstate",
"fipscty"))
save(zipMap, file = "zipCityCountyStateMap.Rda")
library(ggmap)
library(plyr)
library(RJSONIO)
library(acs)
#List of Counties around South Bend
cntyList=c("St. Joseph","Cass")
# get list of zips in the South Bend area
zips=zipMap[zipMap$ctyname %in% cntyList,]
# remove duplicates
zips2=zips[!duplicated(zips$ZCTA5),]
head(zips2)
zipShp <- rgdal::readOGR("cb_2015_us_zcta510_500k//cb_2015_us_zcta510_500k.shp")
zipShp2 <- zipShp[zipShp$ZCTA5CE10 %in% zips2$ZCTA5,]
zipShp2 <- fortify(zipShp2,region="ZCTA5CE10")
x <- get_googlemap(center="south bend",maptype=c("roadmap"))
map <- ggmap(x)
map + geom_polygon(data=zipShp2, aes(x=long, y=lat, group=id), fill = "blue", color = "black", alpha = .2)
api.key.install("4f56e4ff2ade70c0c3cc47779dd337334e6703d6")
household_income <- acs.fetch(2015, geography = geo.make(zip.code = zips2$ZCTA5), table.number = "B25119")
